<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Data Input</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
          crossorigin="anonymous"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
          crossorigin="anonymous"/>
    <style>
            body {
                font-family: sans-serif;
                margin: 0;
                padding: 0;
            }

            .container {
                max-width: 1200px;
                margin: auto;
                padding: 20px;
                background: #f4f4f4;
                border-radius: 8px;
                border: 2px solid;
                overflow: hidden;
            }

            .header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
            }

            .header h1,
            .header h3 {
                margin: 0;
            }

            .info {
                display: flex;
                flex-wrap: wrap;
                gap: 10px; /* Reduce space between each .info-line */
                margin-bottom: 10px;
            }

            .info-line {
                display: flex;
                flex-direction: column;
                flex: 1 1 calc(33.33% - 10px); /* Reduce width for three columns per row with smaller gaps */
                padding: 10px; /* Reduce padding inside the .info-line */
                border: 1px solid #ccc; /* Border around the .info-line */
                border-radius: 4px; /* Reduce border radius for less rounded corners */
                background-color: #f9f9f9; /* Background color for the .info-line */
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); /* Reduce shadow */
                margin-bottom: 10px; /* Reduce space at the bottom of each .info-line */
            }

            .info-line label {
                font-size: 12px; /* Reduce font size of the label */
                margin-bottom: 3px; /* Reduce space between the label and input */
                font-weight: bold; /* Bold label text */
                color: #333; /* Label text color */
            }

            .info-line input[type="text"],
            .info-line input[type="number"],
            .info-line input[type="date"],
            .info-line select {
                width: 100%; /* Full width of the .info-line */
                padding: 5px; /* Reduce padding inside the input */
                font-size: 12px; /* Reduce font size for better readability */
                border: 1px solid #ccc; /* Border around the input */
                border-radius: 3px; /* Reduce rounded corners of the input */
                box-sizing: border-box; /* Include padding and border in the element's total width and height */
            }

            .info-line input[type="text"]:focus,
            .info-line input[type="number"]:focus,
            .info-line input[type="date"]:focus,
            .info-line select:focus {
                border-color: #4CAF50; /* Border color on focus */
                outline: none; /* Remove default outline */
                box-shadow: 0 0 3px rgba(76, 175, 80, 0.5); /* Subtle shadow on focus */
            }


            .pname {
                text-align: center;
                font-size: 24px;
                font-family: 'Roboto Condensed', sans-serif;
                margin-bottom: 10px;
                color: #333;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 20px;
                border: 2px solid black;
            padding: 8px;
            text-align: center;
            }

            .table-container {
                max-height: 345px; /* Adjust the height as needed to show approximately 5 rows */
                overflow-y: auto;
                overflow-x: auto;
            }

            table, th, td {
                border: 1px solid black;
                padding: 8px;
                text-align: left;

            }

            th {
                background-color: #f2f2f2;
                position: sticky;
                top: 0;
                z-index: 2;
                border: 2px solid black;
            padding: 8px;
            text-align: center;

            }

            th:first-child {
                left: 0;
                z-index: 3;
                background-color: #f2f2f2;
                border: 2px solid black;
            padding: 8px;
            text-align: center;
            }

            td:first-child {
                position: sticky;
                left: 0;
                background-color: white;
                z-index: 1;
                border: 2px solid black;
            padding: 8px;
            text-align: center;
            }

            .button-container {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-top: 20px;
            }

            .button {
                text-align: center;
            }

            .button button {
                padding: 10px 20px;
                background-color: #4CAF50;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
            }

            .button button:hover {
                background-color: #3e8e41;
            }

            .delete-btn {
                background-color: #dc3545;
                color: white;
                border: none;
                padding: 6px 12px;
                cursor: pointer;
            }
        </style>
</head>
<body>
   <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar">
      <div class="navbar-nav">
        <a class="nav-item nav-link" id="home" href="/"><i class="fa fa-home"></i> Home</a>
        <a class="nav-item nav-link" id="all" href="/all"><i class="fa fa-briefcase"></i> Projects</a>
        <a class="nav-item nav-link" id="gantt" href="/gantt"><i class="fa fa-bar-chart"></i> GTC</a>
        <a class="nav-item nav-link" id="pmt" href="/pmt"><i class="fa fa-tasks"></i> PMT</a>
        <a class="nav-item nav-link" id="ppt" href="/ppt"><i class="fa fa-line-chart"></i> PPT</a>
        <a class="nav-item nav-link" id="stock" href="/stock"><i class="fa fa-cubes"></i> MR</a>
      </div>
      <div class="navbar-nav ml-auto">
        <a class="nav-item nav-link" id="logout" href="/logout"><i class="fa fa-sign-out"></i> Logout</a>
      </div>
    </div>
  </nav>
    <br> <br>
<div class="container">
    <form action="/add_stock" method="POST">
        <div class="header">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" width="100">
        </div>
        <div class="pname">
            <h2><strong>Project Name: {{ email }}</strong></h2>
        </div>
        <br><br>


        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th colspan = "1"></th>
                        <th colspan = "3"> Details </th>
                        <th colspan = "4"> Quantity </th>
                        <th colspan = "2"> Site team </th>
                        <th colspan = "2"> Procurement team </th>
                    </tr>
                <tr>
                    <th>Sl. No.</th>
                        <th>Type</th>
                        <th>Item name</th>
                        <th>Make</th>

                        <th>IOF Qty</th>
                        <th>Stock Qty</th>
                        <th>Requisition Quantity</th>
                        <th>Cumulative</th>
                        <th>Materials Requisition Date</th>
                        <th>Remarks</th>
                        <th>Materials Delivery Date</th>
                        <th>Remarks</th>
                </tr>
                </thead>
                <tbody id="productTableBody">
                {% for product in products %}
                {% if product.item %}
                <tr data-product-id="{{ product.id }}">
                    <td>{{ loop.index }}</td>

                    <td>
                        <select name="menu[]">
                            <option value="Accessories" {% if product.menu == 'Accessories' %}selected{% endif %}>Accessories</option>
                            <option value="Tools and Tackles" {% if product.menu == 'Tools and Tackles' %}selected{% endif %}>Tools and Tackles</option>
                            <option value="Site Assets" {% if product.menu == 'Site Assets' %}selected{% endif %}>Site Assets</option>

                        </select>

                    </td>
                    <td><input type="text" name="item[]" value="{{ product.item }}"></td>
                    <td><input type="text" name="make[]" value="{{ product.make }}"></td>
                    <td><input type="number" name="iof[]" value="{{ product.iof }}"></td>


                    <td><input type="number" name="stock[]" value="{{ product.stock }}"></td>
                    <td><input type="number" name="unit[]" value="{{ product.unit }}"></td>

                    <td><input type="number" name="cumulative[]" value="{{ product.cumulative }}"></td>
                    <td><input type="date" name="date1[]" value="{{ product.date1 }}"></td>
                    <td><input type="text" name="remarks1[]" value="{{ product.remarks1 }}"></td>
                    <td><input type="date" name="date2[]" value="{{ product.date2 }}"></td>
                    <td><input type="text" name="remarks2[]" value="{{ product.remarks2}}"></td>
                    <td>
                        <button type="button" class="delete-btn" onclick="deleteProduct('{{ product.id }}')">Delete</button>
                    </td>
                </tr>
                {% endif %}
                {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="button-container">
            <div class="button">
                <button type="button" onclick="addRow()">Add Row</button>
            </div>
            <div class="button">
                <button type="submit">Submit</button>
            </div>
        </div>
    </form>



</div>
<br> <br>
<script>
    function deleteProduct(id) {
        if (confirm("Are you sure you want to delete this product?")) {
            if (id.startsWith('new-row')) {
                const row = document.querySelector(`tr[data-product-id="${id}"]`);
                row.remove();
            } else {
                fetch(`/delete_product2/${id}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Success:', data);
                    window.location.reload();
                })
                .catch(error => {
                    console.error('Error:', error);
                    window.location.reload();
                });
            }
        }
    }

    function addRow() {
        const tableBody = document.getElementById('productTableBody');
        const rowCount = tableBody.rows.length + 1;
        const newRowId = `new-row-${rowCount}`;
        const newRowHtml = `
            <tr data-product-id="${newRowId}">
                <td>${rowCount}</td>
                <td>
                    <select name="menu[]">
                        <option value="Accessories">Accessories</option>
                        <option value="Tools and Tackles">Tools and Tackles</option>
                        <option value="Site Assets">Site Assets</option>
                    </select>
                </td>
                <td><input type="text" name="item[]" value="{{email}}/"></td>
                <td><input type="text" name="make[]"></td>

                <td><input type="number" name="iof[]" value = "0"></td>

                <td><input type="number" name="stock[]" value = "0"></td>
                <td><input type="number" name="unit[]" value = "0"></td>

                <td><input type="number" name="cumulative[]"></td>
                <td><input type="date" name="date1[]"></td>
                <td><input type="text" name="remarks1[]"></td>
                <td><input type="date" name="date2[]"></td>
                <td><input type="text" name="remarks2[]"></td>
                <td>
                    <button type="button" class="delete-btn" onclick="deleteProduct('${newRowId}')">Delete</button>
                </td>
            </tr>
        `;
        tableBody.insertAdjacentHTML('beforeend', newRowHtml);
    }
</script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"
        integrity="sha384-9CQY0C1JXYm6yl6AR5ZlrGcQH/Tm5IwJCRTAJk3gZhcVnza3pne+LPRK7xkI8mUA"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
</body>
</html>




